# å®Œæ•´é¡µé¢è¾¹ç•Œæ£€æŸ¥æ”¹è¿›

## ğŸ¯ é—®é¢˜æè¿°
æ–‡å­—å†…å®¹è¶…å‡ºé¡µçœ‰é¡µè„šåŒºåŸŸå’Œå·¦å³é¡µè¾¹è·ï¼Œå³ä½¿æ¢é¡µä¹Ÿæ— æ³•æ­£ç¡®é™åˆ¶å†…å®¹åœ¨ä¸»ä½“åŒºåŸŸå†…ã€‚

## âœ… å®æ–½çš„æ”¹è¿›

### 1. WPLayouter ä¸­çš„ä¸¥æ ¼è¾¹ç•Œæ£€æŸ¥
- **å‚ç›´è¾¹ç•Œ**:
  - `spanH > minRequiredSpace` (50åƒç´ )
  - `(dy + minRequiredSpace) <= (pageHeight - bottomMargin)` - ç¡®ä¿ä¸ä¼šä¾µå…¥é¡µè„šåŒºåŸŸ
- **æ°´å¹³è¾¹ç•Œ**:
  - `paraX >= leftMargin` - ç¡®ä¿ä¸ä¼šè¶…å‡ºå·¦é¡µè¾¹è·
  - `paraEndX <= (pageWidth - rightMargin)` - ç¡®ä¿ä¸ä¼šè¶…å‡ºå³é¡µè¾¹è·
  - æ·»åŠ æ®µè½å®½åº¦å’Œä½ç½®çš„è¯¦ç»†æ£€æŸ¥

### 2. LayoutKit ä¸­çš„ä¸¥æ ¼è¡Œè¾¹ç•Œæ£€æŸ¥
- **å‚ç›´æ£€æŸ¥**:
  - `spanH - lineHeight < 0` - ä¸å…è®¸ä»»ä½•é«˜åº¦è¶…å‡º
  - `currentY > maxAllowedY` - æ£€æŸ¥æ˜¯å¦ä¼šè¶…å‡ºé¡µé¢ç»å¯¹è¾¹ç•Œ
- **æ°´å¹³æ£€æŸ¥**:
  - `currentX < minAllowedX` - æ£€æŸ¥æ˜¯å¦è¶…å‡ºå·¦è¾¹ç•Œ
  - `lineEndX > maxAllowedX` - æ£€æŸ¥æ˜¯å¦è¶…å‡ºå³è¾¹ç•Œ
  - è€ƒè™‘è¡Œçš„å®é™…å®½åº¦å’Œä½ç½®

### 3. BREAK_LIMIT å¤„ç†ä¸­çš„ç»å¯¹è¾¹ç•Œæ£€æŸ¥
- **ç›¸å¯¹è¾¹ç•Œ**: åŸºäºspanWçš„å³è¾¹è·é¢„ç•™
- **ç»å¯¹è¾¹ç•Œ**: åŸºäºpageAttrçš„ç»å¯¹é¡µé¢è¾¹ç•Œæ£€æŸ¥
- **åŒé‡éªŒè¯**: åŒæ—¶æ»¡è¶³ç›¸å¯¹å’Œç»å¯¹è¾¹ç•Œæ¡ä»¶æ‰å…è®¸ç»§ç»­

### 4. å¢å¼ºçš„è°ƒè¯•ä¿¡æ¯
- å‚ç›´å’Œæ°´å¹³è¾¹ç•Œæ£€æŸ¥çš„è¯¦ç»†æ—¥å¿—
- æ˜¾ç¤ºå½“å‰ä½ç½®ä¸æœ€å¤§/æœ€å°å…è®¸ä½ç½®çš„æ¯”è¾ƒ
- æ˜¾ç¤ºé¡µé¢å°ºå¯¸å’Œæ‰€æœ‰è¾¹è·ä¿¡æ¯

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### å‚ç›´è¾¹ç•Œè®¡ç®—å…¬å¼
```java
int maxAllowedY = pageAttr.pageHeight - pageAttr.bottomMargin;
boolean withinVerticalBounds = (dy + minRequiredSpace) <= maxAllowedY;
```

### æ°´å¹³è¾¹ç•Œè®¡ç®—å…¬å¼
```java
int maxAllowedX = pageAttr.pageWidth - pageAttr.rightMargin;
int minAllowedX = pageAttr.leftMargin;
boolean withinHorizontalBounds = (currentX >= minAllowedX) && (lineEndX <= maxAllowedX);
```

### ç»å¯¹é¡µé¢è¾¹ç•Œæ£€æŸ¥
```java
int absoluteX = x + dx + leafWidth;
boolean withinAbsolutePageBounds = (x + dx >= minAbsoluteX) && (absoluteX <= maxAbsoluteX);
```

### æ£€æŸ¥æ¡ä»¶å±‚æ¬¡
1. **åŸºç¡€ç©ºé—´æ£€æŸ¥**: ç¡®ä¿æœ‰è¶³å¤Ÿçš„å‰©ä½™ç©ºé—´
2. **ç›¸å¯¹è¾¹ç•Œæ£€æŸ¥**: åŸºäºå¯ç”¨å®½åº¦çš„è¾¹è·æ£€æŸ¥
3. **ç»å¯¹è¾¹ç•Œæ£€æŸ¥**: åŸºäºé¡µé¢å®é™…å°ºå¯¸çš„è¾¹ç•Œæ£€æŸ¥
4. **è¾¹è·ä¿æŠ¤**: é¢„ç•™ç©ºé—´é˜²æ­¢ä¾µå…¥é¡µçœ‰é¡µè„šå’Œå·¦å³è¾¹è·

## ğŸ“Š é¢„æœŸæ•ˆæœ
- æ–‡å­—å†…å®¹ä¸¥æ ¼é™åˆ¶åœ¨é¡µé¢ä¸»ä½“åŒºåŸŸå†…
- ä¸ä¼šä¾µå…¥é¡µçœ‰ã€é¡µè„šå’Œå·¦å³é¡µè¾¹è·åŒºåŸŸ
- æ›´å‡†ç¡®çš„åˆ†é¡µå’Œæ¢è¡Œå¤„ç†
- æ›´å¥½çš„æ–‡æ¡£æ˜¾ç¤ºè´¨é‡å’Œä¸“ä¸šå¤–è§‚
- æ”¯æŒå¤æ‚å¸ƒå±€ï¼ˆè¡¨æ ¼ã€å¤šåˆ—ç­‰ï¼‰çš„è¾¹ç•Œæ§åˆ¶

## ğŸ” æ£€æŸ¥è¦†ç›–èŒƒå›´
- âœ… å‚ç›´è¾¹ç•Œï¼ˆé¡µçœ‰/é¡µè„šï¼‰
- âœ… æ°´å¹³è¾¹ç•Œï¼ˆå·¦å³é¡µè¾¹è·ï¼‰
- âœ… æ®µè½çº§åˆ«æ£€æŸ¥
- âœ… è¡Œçº§åˆ«æ£€æŸ¥
- âœ… å­—ç¬¦çº§åˆ«æ£€æŸ¥ï¼ˆBREAK_LIMITï¼‰
- âœ… è¡¨æ ¼å†…å®¹æ£€æŸ¥
- âœ… ç»å¯¹å’Œç›¸å¯¹è¾¹ç•ŒåŒé‡éªŒè¯

è¿™äº›æ”¹è¿›ç¡®ä¿äº†æ–‡æ¡£å†…å®¹åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½ä¸¥æ ¼ä¿æŒåœ¨æ­£ç¡®çš„é¡µé¢è¾¹ç•Œå†…ï¼Œæä¾›å®Œç¾çš„æ–‡æ¡£æ˜¾ç¤ºæ•ˆæœã€‚