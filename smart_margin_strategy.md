# 智能右边距策略

## 🎯 问题分析
从日志中发现的问题：
- **表格单元格过窄**: `totalW: 61`, `totalW: 76` - 表格单元格宽度很小
- **右边距预留过多**: 在61像素宽度中预留20像素，占用了33%的空间
- **过度换行**: 导致文本被强制分成很多短行

## 📊 原始策略问题
```
totalW: 61, rightMarginReserve: 20, finalSpanW: 41
maxAllowed: 21, margin: 20
```
- 61像素总宽度
- 预留20像素右边距（33%）
- 只剩41像素可用宽度
- 实际文本只能用21像素（34%）

## ✅ 新的智能策略

### 段落级别右边距预留
```java
if (w < 100) {
    // 很窄容器：预留5-10%
    rightMarginReserve = Math.max(5, w / 10);
} else if (w < 300) {
    // 中等容器：预留6.7%
    rightMarginReserve = Math.max(10, w / 15);
} else {
    // 宽容器：预留5%
    rightMarginReserve = Math.max(20, w / 20);
}
```

### BREAK_LIMIT级别右边距预留
```java
if (spanW < 100) {
    // 很窄空间：预留6.7%
    rightMarginReserve = Math.max(3, spanW / 15);
} else if (spanW < 300) {
    // 中等空间：预留8.3%
    rightMarginReserve = Math.max(8, spanW / 12);
} else {
    // 宽空间：预留10%
    rightMarginReserve = Math.max(15, spanW / 10);
}
```

## 📈 预期改进效果

### 对于61像素宽度的表格单元格
- **原来**: 预留20像素（33%），可用41像素
- **现在**: 预留6像素（10%），可用55像素
- **改进**: 增加34%的可用空间

### 对于76像素宽度的表格单元格
- **原来**: 预留20像素（26%），可用56像素
- **现在**: 预留8像素（11%），可用68像素
- **改进**: 增加21%的可用空间

## 🎯 核心优势
1. **自适应策略**: 根据容器宽度智能调整预留空间
2. **保持边距**: 仍然预留必要的右边距，避免文本贴边
3. **提高利用率**: 在窄容器中最大化可用空间
4. **减少换行**: 减少不必要的强制换行
5. **保持美观**: 在宽容器中保持充足的边距

这种智能策略确保了在各种容器宽度下都能获得最佳的文本布局效果。